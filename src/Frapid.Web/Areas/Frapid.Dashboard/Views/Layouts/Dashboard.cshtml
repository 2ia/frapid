@model dynamic
@using Frapid.ApplicationState.Cache
@using Frapid.i18n
@using Newtonsoft.Json
<!DOCTYPE html>
<html data-ng-app="FrapidApp">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="description" content="Frapid Framework" />
    <title data-ng-bind="$root.title">@ViewBag.Title</title>
    <link href="~/Scripts/semantic-ui/semantic.min.css" rel="stylesheet" />
    <script src="~/i18n/resources.js"></script>
    <script src="~/bundles/backend.js"></script>
    <script src="~/Scripts/frapid/utitlities/validator.js"></script>
    <script src="/Scripts/angular-route.min.js"></script>
    <style>
        #PhoneMenu a {
            display: block !important;
            text-align: center !important;
            padding: 8px 0;
            font-weight: bold;
            color: #76797A;
        }

        #PhoneMenu a {
            font-size: 12px;
        }

            #PhoneMenu a span {
                display: block;
                margin: 12px !important;
            }

            #PhoneMenu a:hover, #PhoneMenu a:active, #PhoneMenu a:focus {
                color: #0556B3;
                box-shadow: inset 0 0 100px 100px rgba(255, 255, 255, 0.3);
                outline: none;
            }

        .large.icon {
            font-size: 34px !important;
            text-align: center !important;
        }

        .ui.link span.text {
            padding: 8px 0 !important;
            display: block !important;
            text-align: center !important;
        }

        #Search input {
            text-align: center;
        }

            #Search input:focus {
                min-width: 30vw;
            }

            .hidden, .initially.hidden {
                display: none;
            }
    html, body, div, p, table, td, th {
        font-size: 12px;
    }
    
    label, .ui.toggle.checkbox label {
        cursor:pointer;
    }
    </style>
</head>
<body>
<div class="ui attached basic small inverted violet menu">
    <a class="item" data-ng-click="toogleDashboard();">
        <i class="mini pin icon"></i>
    </a>
    <div class="right stackable menu">
        <a class="item" href="/" target="_blank" title="Go to Website">
            <i class="mini world icon"></i>
        </a>
        <a class="item">
            <i class="mini mail icon"></i>
        </a>
        <a class="item" href="/account/sign-out" target="_self">
            <i class="mini log out icon"></i>
        </a>
    </div>
</div>
<div id="dashboard-container" class="ui basic attached segment" style="background-color: #E8E8E8; height: 100%;">
    <script>
        $.getJSON("/dashboard/meta", function (response) {
            window.meta = response;
            window.culture = meta.Culture;
            window.language = meta.Language;
            window.jqueryUIi18nPath = meta.JqueryUIi18NPath;
            window.today = meta.Today;
            window.now = meta.Now;
            window.date = today;
            window.userId = meta.UserId;
            window.user = meta.User;
            window.office = meta.Office;
            window.metaView = meta.MetaView;
            window.shortDateFormat = meta.ShortDateFormat;
            window.longDateFormat = meta.LongDateFormat;
            window.thousandSeparator = meta.ThousandSeparator;
            window.decimalSeparator = meta.DecimalSeparator;
            window.currencyDecimalPlaces = meta.CurrencyDecimalPlaces;
            window.currencySymbol = meta.CurrencySymbol;
            window.datepickerFormat = window.convertNetDateFormat(meta.DatepickerFormat);
            window.datepickerShowWeekNumber = meta.DatepickerShowWeekNumber;
            window.datepickerWeekStartDay = meta.DatepickerWeekStartDay;
            window.datepickerNumberOfMonths = meta.DatepickerNumberOfMonths;
        });

    </script>
    <script>
        var viewPath = "@ViewBag.ViewPath";
        var lastPage;
        var frapidApp = angular.module('FrapidApp', ['ngRoute']);





        frapidApp.config(function ($routeProvider, $locationProvider, $httpProvider) {
            $httpProvider.defaults.headers.common["X-Requested-With"] = 'XMLHttpRequest';

            $locationProvider.html5Mode({
                enabled: true,
                requireBase: false
            });


            $routeProvider.
                when('/dashboard', {
                    templateUrl: "/dashboard/apps"
                }).
                when('/dashboard/:url*', {
                    templateUrl: function (url) {
                        var path = '/dashboard/' + url.url;


                        var qs = [];

                        for (var q in url) {
                            if (url.hasOwnProperty(q)) {
                                if (q === "url") {
                                    continue;;
                                };

                                if (url.hasOwnProperty(q)) {
                                    qs.push(q + "=" + url[q]);
                                };
                            }
                        };

                        if (qs.length) {
                            path = path + "?" + qs.join("&");
                        };

                        return path;
                    }
                });
        });


        frapidApp.run(function ($rootScope, $location) {
            $rootScope.$on('$locationChangeStart', function (e, n, o) {
            });

            $rootScope.$on('$routeChangeStart', function () {
                $("#dashboard-container").addClass("loading");
            });
            $rootScope.$on('$routeChangeSuccess', function () {
                $("#dashboard-container").removeClass("loading");
            });

            $rootScope.toogleDashboard = function () {
                if (window.location.pathname !== "/dashboard") {
                    lastPage = window.location.pathname;
                    $location.path("/dashboard");
                } else {
                    if (lastPage) {
                        $location.path(lastPage);
                    };
                };

            };
        });
    </script>

    <div data-ng-view>
        @RenderBody()
    </div>
</div>
</body>
</html>
